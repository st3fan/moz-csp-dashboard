{% extends "base.html" %}

{% block content %}

<h2>Global CSP Reports for {{hostname}}</h2>

<div id="chart" data-chart-data-url="/data/timeline/site/{{hostname}}"></div> 

<h3>Top Violations</h3>

<table class="table table-striped">
  <thead>
    <tr>
      <th>Violated Directive</th>
      <th>Count</th>
    </tr>
  </thead>
  {% for v in top_violations %}
    <tr>
      <td><a href="/site/{{hostname}}/directive/{{v[1]}}">{{v[0]}}</a></td>
      <td>{{v[2]}}</td>
    </tr>
  {% else %}
    <td colspan="2">No data. Sad.</td>
  {% endfor %}
</table>

<h3>Top Pages</h3>

<table class="table table-striped">
  <thead>
    <tr>
      <th>Page</th>
      <th>Count</th>
    </tr>
  </thead>
  {% for v in top_pages %}
    <tr>
      <td><a href="/site/{{hostname}}/document/{{v[0]}}">{{v[1]}}</a></td>
      <td>{{v[2]}}</td>
    </tr>
  {% else %}
    <td colspan="2">No data. Sad.</td>
  {% endfor %}
</table>

<h3>Top Blocked Content</h3>

<table class="table table-striped">
  <thead>
    <tr>
      <th>Page</th>
      <th>Count</th>
    </tr>
  </thead>
  {% for v in top_blockers %}
    <tr>
      <td>{{v[0][:80]}}</td>
      <td>{{v[1]}}</td>
    </tr>
  {% else %}
    <td colspan="2">No data. Sad.</td>
  {% endfor %}
</table>

<h3>Top User Agents</h3>

<table class="table table-striped">
  <thead>
    <tr>
      <th>User Agent</th>
      <th>Count</th>
    </tr>
  </thead>
  {% for v in top_useragents %}
    <tr>
      <td>{{v[1]}}</td>
      <td>{{v[2]}}</td>
    </tr>
  {% else %}
    <td colspan="2">No data. Sad.</td>
  {% endfor %}
</table>

{% endblock %}

{% block scripts %}
<script src="/static/js/csp-site.js"></script></a>
{% endblock %}
